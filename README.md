# ReceiptTask

Тестовое задание для CLEVERTEC

## О проекте

Поставленная задача - разработать консольное приложение, реализующее функционал формирования чека в магазине:

* приложение запускается с параметрами в переменных окружения в формате itemId-quantity (itemId - идентификатор товара,
  quantity -его количество), Card-1234 означает, что была предъявлена скидочная карта с номером 1234.
* необходимо вывести в консоль сформированный чек, содержащий в себе список товаров и их количество с ценой, а также
  рассчитанную сумму с учетом скидки по предъявленной карте (если она есть).
* среди товаров предусмотреть акционные. Если их в чеке больше пяти, то сделать скидку 10% по этой позиции. Данную
  информацию отразить в чеке.
* реализовать обработку исключений
* реализовать вывод чека в файл.
* организовать чтение исходных данных из файлов
* покрыть функционал юнит-тестами (не менее 70%)

  Дополнительные задачи:
* замена хранения исходных данных в файлах на PostgreSQL
* реализовать RESTFUL - интерфейс
* Развернуть приложение и PostgreSQL в Docker

### Использованный стэк

* Java 17
* Gradle 7.5
* JUnit 5
* Java Servlet API 3.0.1
* Jackson Databind 2.14.1
* PostgreSQL 15.1

## Описание

Приложение реализованное в соответствии с основными пунктами задания находится в ветке "base_version". Реализация
дополнительных пунктов находится в ветке "master".

В проекте применены обязательно требуемые паттерны: Factory(для создания принтеров), Decorator(для расчета различных
скидок в Calculator), Builder(для создания сущности CommonProduct, однако не используется в DiscountCard вследствие
небольшого количества полей). Также в проекте используются следующие паттерны: Singleton, DAO, DTO.

Нижеописанные инструкции выполняются командами из командной строки.

### Инструкция по запуску базовой версии

Необходимо собрать проект в .jar файл следующей командой, находясь в директории архива:

 ```sh
  gradle build
  ```

Далее запустить его, указав необходимые id товаров и их количество, а также номер дисконтной карты при необходимости:

  ```sh
java -cp jar-file-name main-class-name [аргументы] (например 1-2 2-3 3-4 card-1111) 
  ```

Также данные построчно можно передать в файле:

 ```sh
1-2
2-3
3-4
card-1111
  ```

для этого необходимо создать файл с исходными данными и при запуске в аргументы передать название файла в формате:

 ```sh
java -cp jar-file-name main-class-name [file-filename.txt]
  ```

Для выбора печати в консоль или в файл необходимо в поле PRINT_TYPE класса demo/Runner внести "file" или "console" (по
умолчанию печать в консоль).

### Инструкция по запуску расширенной версии с дополнительными пунктами

Основная расширенная верия проекта развернута в Docker. Образ проекта можно найти в
репозитории https://hub.docker.com/repository/docker/bumblebear/receipttask.
Для запуска образа из репозитория необходим файл docker-compose.yaml из прокта. DDL операции работы с базой данных
хранятся в корневом каталоге проетка, в файле init.sql, и используются в том числе для инициализации базы данных при
развертывании проетка с Docker образа, поэтому данный файл также необходим. Развернуть проект можно следующей командой
находясь в директории проекта:

 ```sh
docker compose up
  ```

При развертывании проекта передать исходные данные можно по эндпоинту /order в формате:

 ```sh
 http://host:port/WarFileName/order?[аргументы] (например 1=2&2=3&3=4&card=1234).
  ```

## Контакты

Alexander Statkevich - aastatkevich@gmail.com
Project Link: [https://github.com/AlexanderStatkevich/ReceiptTask](https://github.com/AlexanderStatkevich/ReceiptTask)

<p align="right">(<a href="#readme-top">back to top</a>)</p>